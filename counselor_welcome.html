<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="css/style.css">
	<title>Team Roots</title>
	<style>
		#welcome {
			width: 360px;
			margin: 0 auto 60px;
			color: gray;
		}
	</style>
	<script src="http://www.parsecdn.com/js/parse-1.5.0.min.js"></script>
	<script>
		Parse.initialize("pya3k6c4LXzZMy6PwMH80kJx4HD2xF6duLSSdYUl", "nsAogGRd3LmObBE5jk1E3pilVTDbPGAEHpTZwvob");

		var currentUser = Parse.User.current();
		if (!currentUser) window.location = "counselor_code.html";
	</script>
</head>
<body>
	<div id="container">
		<img id="title" src="img/team-roots-logo.png">

		<div id="welcome">
			Welcome to Team Roots, <span id="counselor-name"></span>!<br>
			<br>
			Add a profile image and bio so students can learn more about you.
		</div>

		<form id="profile-form">
			<input type="text" class="form-field" placeholder="Choose image" onclick="this.nextElementSibling.click()">
			<input type="file" name="image" class="hidden" accept="image/*" onchange="this.previousElementSibling.value = this.value">
			<input type="button" value="Upload" class="button"><br>
			<br>
			<textarea cols="44" rows="5" name="bio" placeholder="Bio"></textarea><br>
			<br><br>
			<input type="submit" value="Finish" class="button">
			<p id="note"></p>
		</form>
	</div>

	<script>
		document.getElementById("counselor-name").textContent = currentUser.get("username");

		document.getElementById("profile-form").addEventListener("submit", function (e) {
			e.preventDefault();

			var form = this;
			var reader = new FileReader();

			reader.onload = function () {
				currentUser.set("photoURL", this.result);
				currentUser.set("bio", form.elements["bio"].value);
				currentUser.save(null, {
					success: function (user) {
						form.reset();
					}
				});
			};

			reader.readAsDataURL(this.elements["image"].files[0]);
		})
	</script>

	<div id="footer">
		<a href="mailto:spencer@teamroots.org" class="get-notified">Contact us</a>
	</div>
</body>
</html>
